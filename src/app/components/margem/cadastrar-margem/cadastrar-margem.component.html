<div class="container">
  <nb-card size="medium" style="max-width: 900px;">
    <nb-card-header style="display: flex; align-self: center;">
      <label for="label" class="label" style="font-size: 18px; font-weight: bold;">Cadastro de Margem</label>
    </nb-card-header>
    <nb-card-body>
      <nb-stepper orientation="horizontal">
        <nb-step label="Dados">
          <form>
            <div style="display: flex;">
              <!-- Coluna esquerda -->
              <div style="flex: 1; margin-right: 10px;">
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="linha" style="width: 100px;">Linha:</label>
                    <input [(ngModel)]="margemCompleta.margemDto.linha" name="linha" shape="semi-round" nbInput fullWidth type="text">
                  </div>
                </div>

                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="cliente" style="width: 100px;">Cliente:</label>
                    <input
                      name="cliente"
                      shape="semi-round"
                      [(ngModel)]="margemCompleta.margemDto.cliente"
                      [formControl]="inputFormControl"
                      nbInput
                      fullWidth
                      type="text"
                      placeholder="Digite nome do seu Cliente"
                      [nbAutocomplete]="auto"
                    />

                    <nb-autocomplete #auto>
                      <nb-option *ngFor="let cliente of filteredClientes$ | async" [value]="cliente.nomeCliente">
                        {{ cliente.nomeCliente }}
                      </nb-option>
                    </nb-autocomplete>
                  </div>
                </div>

                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="margem" style="width: 100px;">Margem TAC(%):</label>
                    <input [(ngModel)]="margemCompleta.margemDto.margem" name="margem" shape="semi-round" nbInput fullWidth type="number">
                  </div>
                </div>
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="kilometragem" style="width: 100px;">Distância (KM):</label>
                    <input [(ngModel)]="margemCompleta.margemDto.kilometragem" name="kilometragem" shape="semi-round" nbInput fullWidth
                      type="number">
                  </div>
                </div>
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="pesoTon" style="width: 100px;">Peso(Ton):</label>
                    <input [(ngModel)]="margemCompleta.margemDto.pesoTon" name="pesoTon" shape="semi-round" nbInput fullWidth
                      type="number">
                  </div>
                </div>
              </div>


              <!-- Coluna direita -->
              <div style="flex: 1;">
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="origem" style="width: 100px;">Origem:</label>
                    <input [(ngModel)]="margemCompleta.margemDto.origem" name="origem" shape="semi-round" nbInput fullWidth type="text">
                  </div>
                </div>

                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="destino" style="width: 100px;">Destino:</label>
                    <input [(ngModel)]="margemCompleta.margemDto.destino" name="destino" shape="semi-round" nbInput fullWidth type="text">
                  </div>
                </div>
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="margem" style="width: 100px;">Margem AGR(%):</label>
                    <input [(ngModel)]="margemCompleta.margemDto.margemAgr" name="margem" shape="semi-round" nbInput fullWidth
                      type="number">
                  </div>
                </div>
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="frete" style="width: 100px;">Frete:</label>
                    <input [(ngModel)]="margemCompleta.margemDto.frete" (ngModelChange)="calcularICMS()" name="frete" shape="semi-round"
                      nbInput fullWidth type="number">
                  </div>
                </div>
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="icms" style="width: 100px;">ICMS (R$):</label>
                    <input [(ngModel)]="margemCompleta.margemDto.icms" name="icms" shape="semi-round" disabled nbInput fullWidth
                      type="number">
                  </div>
                </div>
              </div>
            </div>
            <div class="col-sm-6">
              <div class="form-group">
                <label class="label" for="observacao" class="label">Observações</label>
              </div>
            </div>
            <textarea rows="5" nbInput fullWidth name="observacao" shape="round" id="observacao" placeholder=""
              name="observacao" required nbInput class="custom-textarea" [(ngModel)]="margemCompleta.margemDto.observacao"></textarea>
            <!-- botao de continuar-->
            <button nbButton status="info" fullWidth outline shape="semi-round" class="button-step2" nbStepperNext
              [disabled]="!todosCamposSelecionados()" (click)="verdados()">Continuar</button>

          </form>
        </nb-step>

        <!-- Step 2-->
        <nb-step label="Valores">
          <form>
            <div style="display: flex;">
              <!-- Coluna esquerda -->
              <div style="flex: 1; margin-right: 10px;">
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="fe" style="width: 100px;margin-right: 1rem;">FE (R$):</label>
                    <input [(ngModel)]="margemCompleta.valoresMargemDto.fe" name="fe" shape="semi-round" nbInput fullWidth type="number">
                  </div>
                </div>
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="fetruck" style="width: 100px;margin-right: 1rem;">FE TRUCK (R$):</label>
                    <input [(ngModel)]="margemCompleta.valoresMargemDto.feTruck" name="fetruck" shape="semi-round" nbInput fullWidth type="number">
                  </div>
                </div>
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="feBitrem" style="width: 100px;margin-right: 1rem;">FE BITREM (R$):</label>
                    <input [(ngModel)]="margemCompleta.valoresMargemDto.feBitrem" name="feBitrem" shape="semi-round" nbInput fullWidth type="number">
                  </div>
                </div>
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="feCarreta" style="width: 100px;margin-right: 1rem;">FE CARRETA (R$):</label>
                    <input [(ngModel)]="margemCompleta.valoresMargemDto.feCarreta" name="feCarreta" shape="semi-round" nbInput fullWidth
                      type="number">
                  </div>
                </div>
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="feGranel" style="width: 100px;margin-right: 1rem;">FE GRANEL (R$):</label>
                    <input [(ngModel)]="margemCompleta.valoresMargemDto.feGranel" name="feGranel" shape="semi-round" nbInput fullWidth
                      type="number">
                  </div>
                </div>
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="feRodoTrem" style="width: 100px;margin-right: 1rem;">FE RODO TREM (R$):</label>
                    <input [(ngModel)]="margemCompleta.valoresMargemDto.feRodotrem" name="feRodoTrem" shape="semi-round" nbInput fullWidth
                      type="number">
                  </div>
                </div>
              </div>


              <!-- Coluna direita -->
              <div style="flex: 1;">
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="FM" style="width: 100px;margin-right: 1rem;">FM (R$):</label>
                    <input [(ngModel)]="margemCompleta.valoresMargemDto.fm" name="FM" shape="semi-round" nbInput fullWidth type="number">
                  </div>
                </div>

                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="fmTruck" style="width: 100px;margin-right: 1rem;">FM TRUCK (R$):</label>
                    <input [(ngModel)]="margemCompleta.valoresMargemDto.fmTruck" name="fmTruck" shape="semi-round" nbInput fullWidth type="number">
                  </div>
                </div>
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="fmBitrem" style="width: 100px;margin-right: 1rem;">FM BITREM (R$):</label>
                    <input [(ngModel)]="margemCompleta.valoresMargemDto.fmBitrem" name="fmBitrem" shape="semi-round" nbInput fullWidth
                      type="number">
                  </div>
                </div>
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="fmCarreta" style="width: 100px;margin-right: 1rem;">FM CARRETA (R$):</label>
                    <input [(ngModel)]="margemCompleta.valoresMargemDto.fmCarreta" name="fmCarreta" shape="semi-round"
                      nbInput fullWidth type="number">
                  </div>
                </div>
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="fmGranel" style="width: 100px; margin-right: 1rem;">FM GRANEL (R$):</label>
                    <input [(ngModel)]="margemCompleta.valoresMargemDto.fmGranel" name="fmGranel" shape="semi-round"  nbInput fullWidth
                      type="number">
                  </div>
                </div>
                <div class="row-container">
                  <div style="display: flex; align-items: center;">
                    <label class="label" for="fmRodotrem" style="width: 100px;margin-right: 1rem;" >FM RODO TREM (R$):</label>
                    <input [(ngModel)]="margemCompleta.valoresMargemDto.fmRodotrem" name="fmRodotrem" shape="semi-round"  nbInput fullWidth
                      type="number">
                  </div>
                </div>
              </div>
            </div>
            <button nbButton status="success" fullWidth outline shape="semi-round" class="button-step2" nbStepperNext
              [disabled]="!todosCamposSelecionados()" (click)="cadastrarMargem()" style="margin-top:5rem ">Cadastrar</button>

          </form>
        </nb-step>
      </nb-stepper>
    </nb-card-body>
  </nb-card>
</div>
